<html>
	<head>
		<script type="text/javascript" src="./forward-about-that-title.js"></script>
		<script type="text/javascript" src="./prefix-why-not-drinking.js"></script>
		<script type="text/javascript" src="./chapter-01-using-this-booklet.js"></script>
		<script type="text/javascript" src="./chapter-02-staying-away-from-the-first-drink.js"></script>
		<script type="text/javascript" src="./chapter-03-using-the-24-hour-plan.js"></script>
		<script type="text/javascript" src="./chapter-04-remembering-alcoholism-is-an-incurable-progressive-and-fatal-disease.js"></script>
		<script type="text/javascript" src="./chapter-05-live-and-let-live.js"></script>
		<script type="text/javascript" src="./chapter-06-getting-active.js"></script>
		<script type="text/javascript" src="./chapter-07-using-the-serenity-prayer.js"></script>
		<script type="text/javascript" src="./chapter-08-changing-old-routines.js"></script>
		<script type="text/javascript" src="./chapter-09-eating-or-drinking-something-usually-sweet.js"></script>
		<script type="text/javascript" src="./chapter-10-making-use-of-telephone-therapy.js"></script>
		<script type="text/javascript" src="./chapter-11-availing-yourself-of-a-sponsor.js"></script>
		<script type="text/javascript" src="./chapter-12-getting-plenty-of-rest.js"></script>
		<script type="text/javascript" src="./chapter-13-first-things-first.js"></script>
		<script type="text/javascript" src="./chapter-14-fending-off-loneliness.js"></script>
		<script type="text/javascript" src="./chapter-15-watching-out-for-anger-and-resentments.js"></script>
		<script type="text/javascript" src="./chapter-16-being-good-to-yourself.js"></script>
		<script type="text/javascript" src="./chapter-17-looking-out-for-over-elation.js"></script>
		<script type="text/javascript" src="./chapter-18-easy-does-it.js"></script>
		<script type="text/javascript" src="./chapter-19-being-grateful.js"></script>
		<script type="text/javascript" src="./chapter-20-remembering-your-last-drunk.js"></script>
		<script type="text/javascript" src="./chapter-21-avoiding-dangerous-drugs.js"></script>
		<script type="text/javascript" src="./chapter-22-eliminating-self-pity.js"></script>
		<script type="text/javascript" src="./chapter-23-seeking-professional-help.js"></script>
		<script type="text/javascript" src="./chapter-24-staying-clear-of-emotional-entanglements.js"></script>
		<script type="text/javascript" src="./chapter-25-getting-out-of-the-if-trap.js"></script>
		<script type="text/javascript" src="./chapter-26-being-wary-of-drinking-occasions.js"></script>
		<script type="text/javascript" src="./chapter-27-letting-go-of-old-ideas.js"></script>
		<script type="text/javascript" src="./chapter-28-reading-the-aa-message.js"></script>
		<script type="text/javascript" src="./chapter-29-going-to-aa-meetings.js"></script>
		<script type="text/javascript" src="./chapter-30-trying-the-12-steps.js"></script>
		<script type="text/javascript" src="./chapter-31-finding-your-own-way.js"></script>
		<script type="text/javascript" src="./chapter-32-the-twelve-steps.js"></script>
		<script type="text/javascript" src="./appendix.js"></script>

	    <script
		    type="text/javascript"
		    src="https://code.jquery.com/jquery-3.7.1.min.js"
		    integrity="sha384-1H217gwSVyLSIfaLxHbE7dRb3v4mYCKbpQvzx0cegeju1MVsGrX5xXxAvs/HgeFs"
		    crossorigin="anonymous"></script>

        <script
            type="text/javascript"
            src="https://code.jquery.com/ui/1.14.1/jquery-ui.min.js"
            integrity="sha384-SStJQoPipVtHHnIgUfDI+jTAbSyU+HMbhwt2XRRNpLIRFg9VguopT6Y4+cdOlkqg"
            crossorigin="anonymous"></script>

        <link
            rel="stylesheet"
            href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css"
            integrity="sha384-vIQIPaHJRqkO8xhnLxSZ0rHF6LyiWXbLF3grsa9pv9yDFyOPGrE1teHOuRNMJoZs"
            crossorigin="anonymous">

		<script type="text/javascript">
			let chapters = null;

			let currentChapterId = 0;

			$(document).ready(
				() => {
					try
					{
						$("button#information").on("click", (event) => {
							$("div#information-dialog").dialog({
								title: "Information",
								modal: true,
								width: "80%",
								height: "auto",
								buttons: {
									"Close": function() {
										$(this).dialog("close");
									}
								}
							});
						});

						chapters = [
							forwardAboutThatTitle, prefixWhyNotDrinking, chapter01, chapter02, chapter03, chapter04, chapter05, chapter06, chapter07, chapter08, chapter09, chapter10, chapter11, chapter12, chapter13, chapter14, chapter15, chapter16, chapter17, chapter18, chapter19, chapter20, chapter21, chapter22, chapter23, chapter24, chapter25, chapter26, chapter27, chapter28, chapter29, chapter30, chapter31, chapter32, appendix
						]

						let newContent = "";

						chapters.forEach((chapter, idx) => {
							const chapterNumber = (idx < 2 || idx === chapters.length - 1) ? "&nbsp;" : (idx - 1).toString();
							newContent += `<dt>${chapterNumber}</dt><dd><a class="show-chapter" attrId="${idx}">${chapter.title}</a></dd>`;
						});

						$("div#accordion dl.toc").append(newContent);

						$("#accordion").accordion({"collapsible": true, "active": false});

						$(".show-chapter").on("click", (event) => {
							event.preventDefault();

							changeChapter(parseInt($(event.target).attr("attrId")));
						})

						$("button#prev").on("click", (event) => changeChapter(currentChapterId - 1));

						$("button#next").on("click", (event) => changeChapter(currentChapterId + 1));

						$("button#increase-font-size").on("click", increaseFontSize);

						$("button#decrease-font-size").on("click", decreaseFontSize);

						changeChapter(0);
					} catch (error) {
						alert(error);
					}
				}
			);

			const changeChapter = (chapterId, titleOverwrite = null) => {
				if (chapterId < 0 || chapterId >= chapters.length) {
					return;
				}

				currentChapterId = chapterId;

				$("div#chapter-content").html(chapters[chapterId].body + "<br><br><br><br><br>");

				$("div#chapter-content").animate({ scrollTop: 0 }, "slow");

				const title = (titleOverwrite !== null) ? titleOverwrite : chapters[chapterId].title;

				$("#accordion h3").html("🔽 " + title);

				$("#accordion").accordion("option", "active", false);

				$("button#prev").css("opacity", (chapterId === 0) ? "0.2" : "1.0");

				$("button#next").css("opacity", (chapterId === chapters.length - 1) ? "0.2" : "1.0");
			};

			const increaseFontSize = (event) => {
				const oldFontClass = $("div#chapter-content").attr("class");

				let newFontClass = oldFontClass;

				switch (oldFontClass) {
					case "font-minus-25-percent":
						newFontClass = "font-minus-20-percent";
					break;
					case "font-minus-20-percent":
						newFontClass = "font-minus-15-percent";
					break;
					case "font-minus-15-percent":
						newFontClass = "font-minus-10-percent";
					break;
					case "font-minus-10-percent":
						newFontClass = "font-minus-05-percent";
					break;
					case "font-minus-05-percent":
						newFontClass = "";
					break;
					case "":
						newFontClass = "font-plus-05-percent";
					break;
					case "font-plus-05-percent":
						newFontClass = "font-plus-10-percent";
					break;
					case "font-plus-10-percent":
						newFontClass = "font-plus-15-percent";
					break;
					case "font-plus-15-percent":
						newFontClass = "font-plus-20-percent";
					break;
					case "font-plus-20-percent":
						newFontClass = "font-plus-25-percent";
					break;
				}

				$("div#chapter-content").attr("class", newFontClass);
			}

			const decreaseFontSize = (event) => {
				const oldFontClass = $("div#chapter-content").attr("class");

				let newFontClass = oldFontClass;

				switch (oldFontClass) {
					case "font-minus-20-percent":
						newFontClass = "font-minus-25-percent";
					break;
					case "font-minus-15-percent":
						newFontClass = "font-minus-20-percent";
					break;
					case "font-minus-10-percent":
						newFontClass = "font-minus-15-percent";
					break;
					case "font-minus-05-percent":
						newFontClass = "font-minus-10-percent";
					break;
					case "":
						newFontClass = "font-minus-05-percent";
					break;
					case "font-plus-05-percent":
						newFontClass = "";
					break;
					case "font-plus-10-percent":
						newFontClass = "font-plus-05-percent";
					break;
					case "font-plus-15-percent":
						newFontClass = "font-plus-10-percent";
					break;
					case "font-plus-20-percent":
						newFontClass = "font-plus-15-percent";
					break;
					case "font-plus-25-percent":
						newFontClass = "font-plus-20-percent";
					break;
				}

				$("div#chapter-content").attr("class", newFontClass);
			}

		</script>
		<style type="text/css">
			#accordion-container {
				position: fixed;
				z-index: 100;
				width: 100%;
			}

			#accordion h3 {
				white-space: nowrap;
			  	overflow: hidden;
			  	text-overflow: ellipsis;
				font-size: 4em;
			}

			#accordion dl.toc {
				overflow-y: scroll;
				position: fixed;
				z-index: 100;
				top: 8.5em;
				width: 100%;
				z-index: 50;
				bottom: 0;
				overflow-y: scroll;
				padding-bottom:8em;
			}


			dl.toc dt, dl.toc dd {
				line-height: 1em;
				padding-top: .25em;
				padding-bottom: .25em;
				padding-left: 0;
				padding-right: 0;
				font-size: 3em;
				clear: none;
				float: left;
			}

			dl.toc dt {
				text-align: right;
			}

			dl.toc dt.a, dl.toc dd a {
				cursor: pointer;
			}

			dl.toc dt {
				width: 2em;
			}

			dl.toc dd {
				float: left;
				width: calc(100% - 3em);
			}

			div#navigation {
				position: fixed;
				height: 3.5em;
				top: 9.5em;
				width: 100%;
				z-index: 50;
			}

			button#prev, button#next {
				position: absolute;
				padding-left: 2em;
				padding-right: 2em;
				top: .25em;
				height: 2.5em;
				max-width: 49%;
				width:10em;
				font-size: 2em;
			}

			button#prev {
				left:0%;
			}

			button#next {
				right: 1%;
			}

			div#content-container {
				position: fixed;
				top: 15em;
				overflow-y: scroll;
				left: 1em;
				right: 1em;
				bottom: 0;
			}
			div#chapter-content {
				left: 1em;
				right: 1em;
				font-family: Verdana;
				font-size: 1.25em;
				text-align: justify;
				overflow-x: scroll;
			}

			div#chapter-content.font-minus-25-percent {
				font-size: calc(1.25em * 0.75);
			}


			div#chapter-content.font-minus-20-percent {
				font-size: calc(1.25em * 0.80);
			}

			div#chapter-content.font-minus-15-percent {
				font-size: calc(1.25em * 0.85);
			}

			div#chapter-content.font-minus-10-percent {
				font-size: calc(1.25em * 0.9);
			}

			div#chapter-content.font-minus-05-percent {
				font-size: calc(1.25em * 0.95);
			}

			div#chapter-content.font-plus-05-percent {
				font-size: calc(1.25em * 1.05);
			}

			div#chapter-content.font-plus-10-percent {
				font-size: calc(1.25em * 1.10);
			}

			div#chapter-content.font-plus-15-percent {
				font-size: calc(1.25em * 1.15);
			}

			div#chapter-content.font-plus-20-percent {
				font-size: calc(1.25em * 1.20);
			}

			div#chapter-content.font-plus-25-percent {
				font-size: calc(1.25em * 1.25);
			}

			div#chapter-content ul {
				text-align: left;
			}

			button#information {
				position: fixed;
				bottom: .5em;
				right: .5em;
				font-size: 3em;
				z-index: 100;
				background-color: transparent;
				border: none;
				z-index: 1000;
			}

			button#increase-font-size,
			button#decrease-font-size {
				position: fixed;
				bottom: .5em;
				color: rgb(78, 78, 255);
				border: none;
				border-radius: 10px;
				font-size: 3em;
				padding-top: 0;
				padding-bottom: 0;
				font-weight: 700;
				font-family: Helvetica;
				line-height: 1.25em;
				z-index: 1000;
			}

			button#decrease-font-size {
				left: 40%;
			}

			button#increase-font-size {
				right: 40%;
			}

			div#information-dialog {
				display: none;
			}

			footer#fade-footer {
				position:fixed;
				height: 5em;
				left: 0;
				right: 0;
				bottom: 0;
				text-align: center;
				font-size: 1.5em;
				background-image: linear-gradient(to bottom, rgba(255,0,0,0), rgba(0,0,0, .8));
				z-index: 999;
			}

			div.ui-dialog-titlebar {
				font-size: 2em;
			}

			div.ui-dialog-content {
				font-size: 1.5em;
			}

			span.ui-button-icon, button.ui-button {
				zoom: 1.5;
			}
		</style>
	</head>

	<body>
		<div id="accordion-container">
			<div id="accordion">
			  <h3>CHAPTERS</h3>
			  <dl class="toc"></dl>
			</div>
		</div>
		<div id="navigation">
			<button id="prev">◀️ Prev</button>
			<button id="next">Next ▶️</button>
		</div>
		<div id="content-container">
			<div id="chapter-content" class=""></div>
		</div>
		<button id="information">ℹ️</button>
			<button id="decrease-font-size">&nbsp;&nbsp;-&nbsp;&nbsp;</button>
			<button id="increase-font-size">&nbsp;&nbsp;+&nbsp;&nbsp;</button>
		<div id="information-dialog">
			<p>
				This is a digital version of the 'Living Sober' booklet, which provides practical advice
				for those in recovery from alcoholism. Use the navigation buttons to explore the chapters.
			</p>
			<p>
				These articles are reprinted pursuant to section 107 of the Copyright Act 1976.
			</p>
			<p>
				Digital and printed copies of Living Sober can be purchased from the Alcoholics Anonymous website: <a target="_blank" href="https://www.aa.org/living-sober-book">AA's Living Sober page</a>
			</p>
			<p>
				Copyright © 2024 Alcoholics Anonymous World Services, Inc.
			</p>
		</div>
		<footer id="fade-footer">
		</footer>
	</body>
</html>
